
### 计算机辅助建模中的运动控制

计算机辅助建模与制造需要对沿着预定运动路径的空间位置进行精确控制。我们将通过使用自适应求积法解决这一问题的核心部分：等分路径，即将任意路径分割为等长度的子路径。

在数值加工问题中，保持路径上的恒定速度更为理想。在每一秒内，机器与材料界面上的前进距离应保持相等。在其他运动规划应用中，包括计算机动画，可能需要更复杂的前进曲线。例如：

- 一只手伸向门把手可能在开始和结束时速度较低，而中间速度较高。
- 机器人和虚拟现实应用需要构造参数化曲线和曲面以供导航。

建立一个路径距离的等增量表通常是第一步。

---

#### 参数化路径描述

假设给定参数化路径：  
$$ P = \{x(t), y(t)\} \, | \, 0 \leq t \leq 1 $$  
图 5.6 显示了示例路径：

$$
\begin{aligned}
x(t) &= 0.5 + 0.3t + 3.9t^2 - 4.7t^3, \\
y(t) &= 1.5 + 0.3t + 0.9t^2 - 2.7t^3.
\end{aligned}
$$

这是由以下四个点定义的 Bézier 曲线：

- (0.5, 1.5),
- (0.6, 1.6),
- (2, 2),
- (0, 0)。

（参见第 3.5 节以了解 Bézier 曲线的详细信息。）  
图中显示了由均匀分布的参数值 $$ t = 0, 1/4, 1/2, 3/4, 1 $$ 定义的点。请注意，参数均匀分布并不意味着弧长均匀分布。

---

#### 问题目标

你的目标是应用求积方法将此路径分割为 $$ n $$ 等长度的子路径。

---

#### 弧长公式

回忆微积分知识，从 $$ t_1 $$ 到 $$ t_2 $$ 的路径弧长由下式给出：

$$
\int_{t_1}^{t_2} \sqrt{x'(t)^2 + y'(t)^2} \, dt.
$$

此积分很少有封闭形式的解，通常使用自适应求积技术来控制路径的参数化。

---

### 建议活动

1. 编写一个 MATLAB 函数，使用自适应求积法计算从 $$ t = 0 $$ 到 $$ t = T $$ 的弧长，其中 $$ T \leq 1 $$。

2. 编写一个程序，对于任意输入 $$ s $$（0 到 1 之间），找到参数 $$ t^*(s) $$，使其满足路径从 $$ t = 0 $$ 到 $$ t = t^*(s) $$ 的弧长除以从 $$ t = 0 $$ 到 $$ t = 1 $$ 的总弧长等于 $$ s $$。使用二分法将 $$ t^*(s) $$ 定位到三位小数精度。  
   - 哪个函数被设定为零？  
   - 初始二分区间应如何选择？

3. 将图 5.6 的路径等分为 $$ n $$ 等长度的子路径，其中 $$ n = 4 $$ 和 $$ n = 20 $$。绘制类似于图 5.6 的图，显示等分路径。如果计算速度较慢，请考虑使用辛普森法优化自适应求积（参见计算机问题 5.4.2）。

4. 在步骤 2 中，用牛顿法替代二分法，并重复步骤 2 和 3。  
   - 需要什么导数？  
   - 初始猜测如何选择？  
   - 此替代方法是否减少了计算时间？

5. 附录 A 展示了 MATLAB 中的动画命令，例如以下命令：

   ```matlab
   set(gca, 'XLim', [-2 2], 'YLim', [-2 2], 'Drawmode', 'fast', ...
       'Visible', 'on');
   cla
   axis square
   ```

   定义一个对象“ball”，其位置 $$(x, y)$$ 可通过以下命令指定：

   ```matlab
   set(ball, 'xdata', x, 'ydata', y); drawnow; pause(0.01)
   ```

   在循环中改变 $$ x $$ 和 $$ y $$ 会使 ball 沿路径在 MATLAB 图窗中移动。  
   使用 MATLAB 的动画命令，分别演示以下两种情况：  

   - 原始参数 $$ 0 \leq t \leq 1 $$ 的速度沿路径移动。  
   - 根据 $$ t^*(s) $$（$$ 0 \leq s \leq 1 $$）的恒定速度沿路径移动。

6. 尝试等分路径并进行动画展示。设计一条自选的 Bézier 曲线路径，将其等分为等弧长段，并按步骤 5 的方法进行动画。

7. 编写一个程序，根据任意前进曲线 $$ C(s) $$（$$ 0 \leq s \leq 1 $$，$$ C(0) = 0 $$ 且 $$ C(1) = 1 $$）沿路径 $$ P $$ 移动。目标是以比例 $$ C(s) $$ 遍历路径的总弧长，例如，恒定速度可表示为 $$ C(s) = s $$。尝试以下前进曲线：

   - $$ C(s) = s^{1/3} $$  
   - $$ C(s) = s^2 $$  
   - $$ C(s) = \sin(\pi s / 2) $$  
   - $$ C(s) = \frac{1}{2} + \frac{1}{2} \sin\left(2s - 1\right)\frac{\pi}{2} $$  

   有关平面和空间曲线重参数化的更多细节与应用，请参考 Wang 等人 [2003] 和 Guenter 与 Parent [1990] 的研究。
